{"openapi":"3.1.0","info":{"version":"1.0.0","title":"OpenAPI"},"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}},"schemas":{"TokenResponse":{"type":"object","properties":{"access_token":{"type":"string"},"refresh_token":{"type":"string"},"expires_in":{"type":"number"},"token_type":{"type":"string"}},"required":["access_token","refresh_token","expires_in","token_type"]},"User":{"type":"object","properties":{"id":{"type":"number","description":"User ID"},"name":{"type":["string","null"],"description":"User name"},"email":{"type":["string","null"],"description":"User email"},"is_admin":{"type":["boolean","null"],"description":"Flag indicating that the user is an Admin user"}},"required":["id","name","email"]},"Format":{"type":"string","enum":["standard","startup","eternal","other"]},"TournamentType":{"type":"string","enum":["GNK / seasonal","asynchronous tournament","circuit breaker","circuit opener","community tournament","continental championship","infinite recursion","intercontinental championship","national championship","online event","store championship","team tournament","worlds championship","regional championship"]},"Result":{"type":"object","properties":{"rank_swiss":{"type":"number"},"rank_cut":{"type":["number","null"]},"season_id":{"type":["number","null"]},"points_earned":{"type":"number"},"tournament_id":{"type":"number"},"tournament_name":{"type":"string"},"tournament_type":{"$ref":"#/components/schemas/TournamentType"},"players_count":{"type":"number"},"corp_deck_identity_id":{"type":"number"},"corp_deck_identity_name":{"type":["string","null"]},"corp_deck_faction":{"type":["string","null"]},"corp_deck_url":{"type":["string","null"]},"runner_deck_identity_id":{"type":"number"},"runner_deck_identity_name":{"type":["string","null"]},"runner_deck_faction":{"type":["string","null"]},"runner_deck_url":{"type":["string","null"]},"user_id":{"type":"number"},"user_name":{"type":"string"},"format":{"$ref":"#/components/schemas/Format"},"count_for_tournament_type":{"type":"number","default":0},"is_valid":{"type":"boolean"}},"required":["rank_swiss","season_id","points_earned","tournament_id","tournament_name","tournament_type","players_count","corp_deck_identity_id","runner_deck_identity_id","user_id","user_name","format","count_for_tournament_type","is_valid"]},"UserResultsResponse":{"type":"object","properties":{"user_name":{"type":"string"},"user_id":{"type":"number"},"rank":{"type":"number"},"seasonId":{"type":"number"},"seasonName":{"type":"string"},"format":{"$ref":"#/components/schemas/Format"},"factionCode":{"type":"string"},"results":{"type":"array","items":{"$ref":"#/components/schemas/Result"}}},"required":["user_name","user_id","rank","results"]},"LeaderboardRow":{"type":"object","properties":{"points":{"type":"number"},"rank":{"type":"number"},"user_id":{"type":"number"},"user_name":{"type":["string","null"]},"attended":{"type":"number"}},"required":["points","rank","user_id","attended"]},"GetPointDistributionResponse":{"type":"object","properties":{"totalPoints":{"type":"number"},"pointDistribution":{"type":"array","items":{"type":"object","properties":{"placement":{"type":"number"},"points":{"type":"number"},"cumulative":{"type":"number"}},"required":["placement","points","cumulative"]}}},"required":["totalPoints","pointDistribution"]},"Faction":{"type":"object","properties":{"code":{"type":"string"},"color":{"type":"string"},"is_mini":{"type":"boolean"},"name":{"type":"string"},"side_code":{"type":"string"}},"required":["code","color","is_mini","name","side_code"]},"Season":{"type":"object","properties":{"id":{"type":"number"},"name":{"type":"string"},"started_at":{"type":"string","format":"date-time"},"ended_at":{"type":["string","null"]}},"required":["id","name","started_at"]},"Tournament":{"type":"object","properties":{"id":{"type":"number"},"name":{"type":"string"},"date":{"type":["string","null"],"format":"date-time"},"players_count":{"type":"number"},"location":{"type":"string"},"concluded":{"type":["boolean","null"]},"format":{"type":"string"},"type":{"type":"string"},"season_id":{"type":["number","null"]},"season_name":{"type":"string"},"season_tier":{"type":"string"}},"required":["id","name","date","players_count","location","format","type","season_id"]},"TournamentConfig":{"type":"object","properties":{"code":{"$ref":"#/components/schemas/TournamentType"},"name":{"type":"string"},"tournament_limit":{"type":"number"},"min_players_to_be_legal":{"type":"number"},"baseline_points":{"type":"number"},"points_per_player":{"type":"number"}},"required":["code","name","tournament_limit","min_players_to_be_legal","baseline_points","points_per_player"]},"RankingConfig":{"type":"object","properties":{"tournament_configs":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/TournamentConfig"}}},"required":["tournament_configs"]}},"parameters":{}},"paths":{"/api/auth/login_url":{"get":{"tags":["Auth"],"summary":"Fetches the NRDB login url","operationId":"get_GetLoginUrl","responses":{"200":{"description":"Object containing the auth_url","content":{"application/json":{"schema":{"type":"string"}}}}}}},"/api/auth/token":{"get":{"tags":["Auth"],"summary":"From the code supplied during the OAuth redirect, perform the secret exchange and create a token","operationId":"get_GetTokenFromCode","parameters":[{"schema":{"type":"string"},"required":true,"name":"code","in":"query"}],"responses":{"200":{"description":"Blob containing the token and refresh_token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}}}}},"/api/auth/refresh_token":{"get":{"tags":["Auth"],"summary":"Attempts to create a new token from the given refresh_token","operationId":"get_RefreshToken","parameters":[{"schema":{"type":"string"},"required":true,"name":"refresh_token","in":"query"}],"responses":{"200":{"description":"Blob containing the token and refresh_token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}}}}},"/api/users/@me":{"get":{"tags":["User"],"summary":"Gets your own profile","security":[{"bearerAuth":[]}],"operationId":"get_Me","responses":{"200":{"description":"Your own user profile","content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}}}}}},"/api/users":{"get":{"tags":["User"],"summary":"Gets a list of all users.","operationId":"get_GetUsers","responses":{"200":{"description":"List of all users","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/User"}}}}}}}},"/api/users/{userID}":{"get":{"tags":["User"],"summary":"Gets a single user","operationId":"get_GetUser","parameters":[{"schema":{"type":"integer","description":"User ID (integer)"},"required":true,"name":"userID","in":"path"}],"responses":{"200":{"description":"User Object","content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}}}}}},"/api/users/{user}/results":{"get":{"tags":["Results"],"summary":"Gets the results for the given user","operationId":"get_GetUserResults","parameters":[{"schema":{"type":"string","description":"Name or ID of the user"},"required":true,"name":"user","in":"path"},{"schema":{"type":["number","null"]},"required":false,"name":"season","in":"query"},{"schema":{"type":"string"},"required":false,"name":"factionCode","in":"query"},{"schema":{"$ref":"#/components/schemas/Format"},"required":false,"name":"format","in":"query"}],"responses":{"200":{"description":"Gets a list of all results for the given user and supplied filters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResultsResponse"}}}}}}},"/api/leaderboard":{"get":{"tags":["Leaderboard"],"summary":"Gets the current season's leaderboard","operationId":"get_GetLeaderboard","parameters":[{"schema":{"type":["number","null"]},"required":false,"name":"seasonId","in":"query"},{"schema":{"type":"string"},"required":false,"name":"factionCode","in":"query"},{"schema":{"$ref":"#/components/schemas/Format"},"required":false,"name":"format","in":"query"}],"responses":{"200":{"description":"Returns a array of rows compromising the full leaderboard for the given season","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/LeaderboardRow"}}}}}}}},"/api/point-distribution":{"get":{"tags":["Leaderboard"],"summary":"Tool to show distribution of points from various given parameters","operationId":"get_GetPointDistribution","parameters":[{"schema":{"type":["number","null"]},"required":false,"name":"numPlayers","in":"query"},{"schema":{"$ref":"#/components/schemas/TournamentType"},"required":false,"name":"type","in":"query"}],"responses":{"200":{"description":"Returns a array of numbers representing the point distribution of the simulated tournament","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetPointDistributionResponse"}}}}}}},"/api/factions":{"get":{"tags":["Leaderboard"],"summary":"Returns a list of Netrunner Factions","operationId":"get_GetFactions","responses":{"200":{"description":"Returns an array Factions","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Faction"}}}}}}}},"/api/formats":{"get":{"tags":["Leaderboard"],"summary":"Returns a list of supported Netrunner Formats","operationId":"get_GetFormats","responses":{"200":{"description":"Returns an array supported Formats","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Format"}}}}}}}},"/api/seasons":{"get":{"tags":["Seasons"],"summary":"Gets a list of all existing and past Seasons.","operationId":"get_GetSeasons","responses":{"200":{"description":"list of Seasons","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Season"}}}}}}}},"/api/seasons/{seasonId}/tournaments":{"get":{"tags":["Seasons"],"summary":"Gets a list of all existing and past Seasons.","operationId":"get_GetSeasonTournaments","parameters":[{"schema":{"type":"number","description":"Season ID"},"required":true,"name":"seasonId","in":"path"}],"responses":{"200":{"description":"list of Tournaments for the given season","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Tournament"}}}}}}}},"/api/tournaments":{"get":{"tags":["Tournament"],"summary":"Gets a list of all Tournaments","operationId":"get_GetTournaments","responses":{"200":{"description":"list of Tournaments","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Tournament"}}}}}}}},"/api/tournaments/config":{"get":{"tags":["Leaderboard"],"summary":"Returns an object containing configuration data for determining the leaderboard","operationId":"get_GetRankingConfig","responses":{"200":{"description":"Returns a RankingConfig object","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RankingConfig"}}}}}}},"/api/tournaments/{tournamentId}":{"get":{"tags":["Tournament"],"summary":"Gets a single tournament","operationId":"get_GetTournament","parameters":[{"schema":{"type":"number","description":"Tournament ID"},"required":true,"name":"tournamentId","in":"path"}],"responses":{"200":{"description":"Full Tournament object","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Tournament"}}}}}}},"/api/tournaments/{tournamentId}/results":{"get":{"tags":["Tournament"],"summary":"Gets a list of results from the given tournament","operationId":"get_GetTournamentResults","parameters":[{"schema":{"type":"number","description":"Tournament ID"},"required":true,"name":"tournamentId","in":"path"}],"responses":{"200":{"description":"List of Results from the supplied tournament","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Result"}}}}}}}},"/api/admin/updateNRDBNames":{"get":{"tags":["Admin"],"summary":"Triggers updating all users names from nrdb","security":[{"bearerAuth":[]}],"operationId":"get_UpdateUsers","responses":{"200":{"description":"Updates all user accounts to pull from NRDB","content":{"application/json":{"schema":{"type":"object","properties":{}}}}}}}},"/api/admin/rerank":{"get":{"tags":["Admin"],"summary":"Triggers a re-rank on all User rows. Limited to admin users","security":[{"bearerAuth":[]}],"operationId":"get_Rerank","responses":{"200":{"description":"Summary of what was changed during the re-ranking","content":{"application/json":{"schema":{"type":"object","properties":{"numberUsersUpdate":{"type":"number"}},"required":["numberUsersUpdate"]}}}}}}},"/api/admin/exportDB":{"get":{"tags":["Admin"],"summary":"Exports the production DB","security":[{"bearerAuth":[]}],"operationId":"get_ExportDB","responses":{"200":{"description":"How many tournaments were updated","content":{"application/json":{"schema":{"type":"object","properties":{"tournamentsUpdated":{"type":"number"}},"required":["tournamentsUpdated"]}}}}}}},"/api/admin/ingestTournament":{"post":{"tags":["Admin"],"summary":"Triggers a background job to ingest tournament data from ABR.","security":[{"bearerAuth":[]}],"operationId":"post_IngestTournament","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"userId":{"type":"number"},"tournamentType":{"type":"integer","enum":[1,2,3,4,5,6,7,8,9,10,11,12,13,14]}}}}}},"responses":{"200":{"description":"Empty object indicates success on triggering ingestion.","content":{"application/json":{"schema":{"type":"object","properties":{}}}}}}}},"/api/admin/ingestTournaments":{"post":{"tags":["Admin"],"summary":"Triggers a background job to ingest all tournament data from ABR.","security":[{"bearerAuth":[]}],"operationId":"post_IngestTournaments","responses":{"200":{"description":"Empty object indicates success on triggering ingestion.","content":{"application/json":{"schema":{"type":"object","properties":{}}}}}}}},"/api/admin/updateCards":{"post":{"tags":["Admin"],"summary":"Fetches and updates the KV that stores the NRDB cards","security":[{"bearerAuth":[]}],"operationId":"post_UpdateCards","responses":{"200":{"description":"Empty object indicates success on updating nrdb cards.","content":{"application/json":{"schema":{"type":"object","properties":{}}}}}}}},"/api/admin/updateTournamentsSeason":{"post":{"tags":["Admin"],"summary":"Triggers a Season start & end date update across all tournaments.","security":[{"bearerAuth":[]}],"operationId":"post_UpdateTournamentSeasons","responses":{"200":{"description":"How many tournaments were updated","content":{"application/json":{"schema":{"type":"object","properties":{"tournamentsUpdated":{"type":"number"}},"required":["tournamentsUpdated"]}}}}}}}},"webhooks":{}}